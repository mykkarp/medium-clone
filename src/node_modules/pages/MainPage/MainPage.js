import React, { useState } from "react";
import "./MainPage.scss";
import { makeStyles } from '@material-ui/core/styles';
import Paper from '@material-ui/core/Paper';
import Container from '@material-ui/core/Container';
import Tabs from "pages/MainPage/Tabs/Tabs.js";
import TagsBar from "components/TagsBar/TagsBar.js";
import useMediaQuery from '@material-ui/core/useMediaQuery';

const useStyle = makeStyles({
  paper: {
    flexGrow: 1,
    flexShrink: 1,
  },
})

const MainPage = ({ currentLang }) => {
  const styles = useStyle();
  const isPlanshet = useMediaQuery('(max-width:823px)');
  const [currentTag, setCurrentTag] = useState("");

  const searchByTagHandler = (e, tag) => {
    if (tag) {
      setCurrentTag(tag.substring(1));
      return;
    }
    const target = e.target.closest("button");
    if (!target) return;
    setCurrentTag(target.textContent);
  }

  return (
    <section className="global-feed">
      <Container style={{ maxWidth: "980px" }}>
        <div
          style={isPlanshet
            ? { padding: "100px 0px 0px", display: "flex", flexDirection: "column" }
            : { padding: "100px 0px 0px", display: "flex", alignItems: "flex-start" }}
        >
          <Paper style={isPlanshet ? null : { margin: "0px 20px 0px 0px" }} className={styles.paper}>
            <Tabs
              searchByTagHandler={searchByTagHandler}
              currentTag={currentTag}
              currentLang={currentLang}
              currentPage="mainPage" />
          </Paper>
          <TagsBar
            searchByTagHandler={searchByTagHandler}
            currentTag={currentTag}
            currentLang={currentLang}
            isPlanshet={isPlanshet} />
        </div>
      </Container>
    </section>
  )
}

export default MainPage;